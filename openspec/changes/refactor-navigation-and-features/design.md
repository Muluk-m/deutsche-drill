## Context

当前德语学习应用存在以下用户体验问题：
1. 功能入口过于分散，测试相关入口在首页、test-modes、底部导航多处重复
2. 首页信息密度高但缺乏层次感，用户难以快速定位目标
3. 缺少主流语言学习应用的核心功能（每日目标、生词本）
4. 德语特殊字符输入不便，影响答题效率

目标用户：德语初学者，需要系统化学习词汇和基础语法。

## Goals / Non-Goals

### Goals
- 建立清晰的功能层次，减少入口重复
- 提供每日学习目标激励机制
- 支持难词标记和专项复习
- 优化德语输入体验

### Non-Goals
- 不涉及云端同步功能
- 不添加社交/排行榜功能
- 不改变现有 SRS 算法逻辑
- 不增加新的测试模式

## Decisions

### 1. 导航结构
**决策**：采用 4-Tab 底部导航（首页、学习、测试、我的）

**理由**：
- 4 个 Tab 是移动端应用的最佳实践
- 将个人相关功能（统计、设置、生词本）集中到 "我的"
- 测试入口统一，避免分散

**备选方案**：
- 保持 3 Tab + 悬浮按钮：增加视觉复杂度
- 5 Tab（增加独立复习 Tab）：Tab 过多影响体验

### 2. 首页布局
**决策**：三段式布局（仪表盘 → 核心入口 → 单元列表）

```
┌─────────────────────────┐
│  学习仪表盘              │
│  • 今日进度 12/20       │
│  • 待复习 5 个          │
│  • 连续学习 7 天        │
├─────────────────────────┤
│  [继续学习]  [智能复习]  │
│  [开始测试]              │
├─────────────────────────┤
│  学习单元                │
│  ▼ 单元 1-5 (展开)      │
│  ▶ 单元 6-10 (折叠)     │
└─────────────────────────┘
```

**理由**：
- 仪表盘提供即时反馈和目标激励
- 核心入口减少到 3 个，降低选择焦虑
- 单元列表可折叠，减少滚动疲劳

### 3. 生词本数据结构
**决策**：使用 LocalStorage 存储，与 SRS 系统独立

```typescript
interface FavoriteWord {
  word: string;
  zh_cn: string;
  addedAt: string;  // ISO date
  note?: string;    // 用户备注
}
```

**理由**：
- 简单直接，无需复杂数据关联
- 与 SRS 独立避免逻辑耦合
- 支持用户添加个人备注

### 4. 每日目标机制
**决策**：目标基于 "学习新词数量"，达成后显示庆祝动画

```typescript
interface DailyGoal {
  target: 10 | 20 | 30 | 50;
  updatedAt: string;  // 目标设置时间
}
```

**理由**：
- 以新词数量为指标，简单易懂
- 复习不计入目标，鼓励持续学习新内容
- 庆祝动画提供正向反馈

### 5. 德语字符输入
**决策**：答题时显示浮动字符栏，点击插入字符

```
输入框: [ Haus___ ]
字符栏: [ ä ] [ ö ] [ ü ] [ ß ] [ Ä ] [ Ö ] [ Ü ]
```

**理由**：
- 不改变原有输入流程
- 点击即插入，操作直观
- 浮动显示不占用固定空间

## Risks / Trade-offs

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 首页改动大，可能影响现有用户习惯 | 中 | 保持核心功能位置稳定，渐进式调整 |
| 单元列表折叠可能让用户找不到内容 | 低 | 默认展开前 2 个单元组，记住用户折叠状态 |
| 生词本功能可能与 SRS 功能重叠 | 低 | 明确定位：SRS 是智能复习，生词本是手动标记 |

## Migration Plan

1. **Phase 1**：添加数据层和 "我的" 页面（不影响现有功能）
2. **Phase 2**：添加德语字符输入（增强现有功能）
3. **Phase 3**：首页重构和导航更新（主要变更）

回滚方案：各阶段独立部署，如有问题可单独回退。

## Open Questions

1. 单元列表分组方式？按 5 个一组还是 10 个一组？
   - **建议**：5 个一组，显示更紧凑
2. 生词本是否需要导出功能？
   - **建议**：暂不需要，未来可考虑


